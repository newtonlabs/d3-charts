(null===d3.charts||"object"!=typeof d3.charts)&&(d3.charts={}),this.d3.charts.barchart=function(){"use strict";function a(a){var f,g=function(){return"undefined"!=typeof f},h=(b-e.left-e.right,c-e.top-e.bottom),i=d3.scale.ordinal().rangeRoundBands([0,b],.3),j=d3.scale.ordinal(),k=d3.scale.linear().range([h,0]),l=d3.svg.axis().scale(i).orient("bottom"),m=d3.svg.axis().scale(k).orient("left");a.each(function(a){var n=d3.keys(a[0]).filter(function(a){return"xAxis"!==a&&"yAxis"!==a&&"target"!==a&&"group"!==a});d=d3.select(this).append("svg").attr("class","barchart").attr("width",b+e.left+e.right).attr("height",c+e.top+e.bottom);var o=d.append("g").attr("transform","translate("+e.left+","+e.top+")");a.forEach(function(a){a.group=n.map(function(b){return{name:b,value:+a[b].value,color:a[b].color}})}),i.domain(a.map(function(a){return a.xAxis})),j.domain(n).rangeRoundBands([0,i.rangeBand()]);var p=d3.min(a,function(a){return d3.min(a.group,function(a){return a.value})});p>0&&(p=0);var q=d3.max(a,function(a){return d3.max(a.group,function(a){return a.value})});"undefined"!=typeof a[0].target&&(f=Number(a[0].target)),g()&&f>q&&(q=f),k.domain([p,q]);var r=h;0>p&&q>0&&(r=h*(q/(q-p)));var s=o.selectAll(".cat").data(a).enter().append("g").attr("class","g").attr("transform",function(a){return"translate("+i(a.xAxis)+",0)"});s.selectAll("rect").data(function(a){return a.group}).enter().append("rect").attr("width",j.rangeBand()).attr("x",function(a){return j(a.name)}).attr("y",function(a){return a.value<0?k(0):k(a.value)}).attr("height",function(a){return a.value<0?k(a.value+q):h-k(a.value+p)}).style("fill",function(a){return a.color}),o.append("g").attr("class","x axis").attr("transform","translate(0,"+r+")").call(l),o.append("svg:g").attr("class","y axis").call(m).selectAll("g").append("svg:foreignObject").attr("width","150px").attr("height","40px").attr("x",-160).attr("y",-20).attr("style","text-align: right;").append("xhtml:div").html(function(a){return a}),o.selectAll(".y.axis g text").remove(),o.select(".y.axis").append("text").attr("y",-20).style("text-anchor","start").text(a[0].yAxis),g()&&o.append("line").attr("class","target").attr("x1",0).attr("y1",k(f)).attr("x2",b).attr("y2",k(f))})}var b=1200,c=400,d={},e={top:50,right:20,bottom:0,left:75};return a.width=function(c){return arguments.length?(b=c,a):b},a.height=function(b){return arguments.length?(c=b,a):c},a.svg=function(){return d},a},(null===d3.charts||"object"!=typeof d3.charts)&&(d3.charts={}),d3.charts.baseBuilder=function(a,b,c){"use strict";var d,e,f,g={};return g.draw=function(){g.setupSvg(),g.setupChart(),g.setupGraphic(),c.chartArea&&g.chartArea(),c.graphicArea&&g.graphicArea(),c.testArea&&g.addTestCircles()},g.setupSvg=function(){d=d3.select(a).append("svg").attr("class","groupStack").attr("width",c.width).attr("height",c.height)},g.setupChart=function(){e=d.append("g").attr("transform","translate("+g.marginLeft()+","+g.marginTop()+")")},g.chartArea=function(){e.append("rect").attr("height",g.chartHeight()).attr("width",g.chartWidth()).attr("x",0).attr("y",0).attr("stroke","steelblue").attr("fill","none").attr("stroke-width","2px")},g.setupGraphic=function(){f=d.append("g").attr("transform","translate("+g.graphicMarginLeft()+","+g.graphicMarginTop()+")")},g.graphicArea=function(){f.append("rect").attr("height",g.graphicHeight()).attr("width",g.graphicWidth()).attr("x",0).attr("y",0).attr("stroke","red").attr("fill","none").attr("stroke-width","2px")},g.addTestCircles=function(){f.selectAll("circle").data([10,20,30]).enter().append("circle").attr("cy",function(a,b){return 100*(b+1)}).attr("cx",function(a,b){return 125*(b+1)}).attr("r",function(a){return a}).attr("stroke-width","2px").attr("fill","steelblue")},g.graphicWidth=function(){return c.leftLabels?g.chartWidth()-c.margin.leftLabel:g.chartWidth()},g.graphicHeight=function(){return c.bottomLabels?g.chartHeight()-c.margin.bottomLabel:g.chartHeight()},g.chartWidth=function(){return c.legend?c.width-c.margin.left-c.margin.right-c.margin.legend:c.width-c.margin.left-c.margin.right},g.chartHeight=function(){return c.titleOn?c.height-c.margin.top-c.margin.bottom-c.margin.title:c.height-c.margin.top-c.margin.bottom},g.marginLeft=function(){return c.margin.left},g.marginTop=function(){return c.titleOn?c.margin.top+c.margin.title:c.margin.top},g.graphicMarginTop=function(){return g.marginTop()},g.graphicMarginLeft=function(){return c.leftLabels?g.marginLeft()+c.margin.leftLabel:g.marginLeft()},g.legendMarginTop=function(){return g.graphicMarginTop()},g.legendMarginLeft=function(){return c.width-c.margin.legend},g.titleMarginLeft=function(){return c.margin.left},g.titleMarginTop=function(){return c.margin.top},g.svg=function(){return d},g.chart=function(){return e},g.graphic=function(){return f},g},(null===d3.charts||"object"!=typeof d3.charts)&&(d3.charts={}),d3.charts.childBuilder=function(a,b,c){"use strict";var d,e=d3.charts.baseBuilder(a,b,c),f=50,g=d3.scale.ordinal(),h=d3.scale.linear(),i=d3.svg.axis(),j=d3.svg.axis(),k=d3.scale.ordinal(),l=d3.format(".3s"),m=d3.layout.stack(),n=d3.charts.legend(),o=d3.charts.noData(),p=d3.charts.chartTitle();return e.draw=function(){var a=_.isEmpty(b);e.setupMargins(),e.setupSvg(),e.setupChart(),e.setupGraphic(),a?e.setupNoData():e.setupData(),c.vertical?e.drawVertical():e.drawHorizontal(),a&&e.drawNoData(),c.titleOn&&e.drawTitle(),c.legend&&e.drawLegend(),c.chartArea&&e.chartArea(),c.graphicArea&&e.graphicArea()},e.setupMargins=function(){c.vertical&&(c.margin.leftLabel=f)},e.setupNoData=function(){d=[],k.domain(["TBD"]).range(["#E6E6E6"]),g.domain(_.map(_.range(7),function(a){return"Label - "+a})),n.color(k)},e.setupData=function(){d=m(b);var a=d3.max(d,function(a){return d3.max(a,function(a){return a.y0+a.y})}),c=d3.utilities.padDomain(e.graphicWidth(),a,f);g.domain(_.map(d[0],function(a){return a.x})),h.domain([0,a+c]),k.domain(e.categories()).range(e.colors()),n.color(k)},e.colors=function(){return _.reduce(d,function(a,b,c){var d=b[0].color?b[0].color:d3.utilities.stackColors[c];return a.push(d),a},[])},e.categories=function(){return _.isEmpty(d)?["TBD"]:_.reduce(d,function(a,b){return a.push(b[0].category),a},[])},e.barColor=function(a){return _.isEmpty(a.color)?k(a.category):a.color},e.lastLayer=function(a){return _.isEmpty(a)?[]:_.last(a)},e.drawNoData=function(){o.x((c.width-300)/2).y(c.height/2-50),e.svg().call(o)},e.legendItems=function(){return c.vertical?e.categories().slice().reverse():e.categories()},e.drawLegend=function(){n.y(e.legendMarginTop()).x(e.legendMarginLeft()),e.svg().datum(e.legendItems()).call(n)},e.drawTitle=function(){p.title(c.title).subTitle(c.subtitle),p.x(e.titleMarginLeft()).y(e.titleMarginTop()),e.svg().call(p)},e.isInt=function(a){return 0===a%1},e.textFormat=function(a){var b=a.y+a.y0;return e.isInt(b)?b>999?l(b):b:l(b)},e.drawVertical=function(){var a=e.graphicHeight(),b=e.graphicWidth(),c=e.graphic();g.rangeRoundBands([0,b],.2),h.range([a,0]);var f=g,m=h,n=j,o=i;o.scale(m).tickSize(b).tickPadding(3).tickFormat(l).outerTickSize([0]).orient("right"),n.scale(f).tickSize(0).orient("bottom");var p=c.append("g").attr("class","vertical y axis").attr("transform","translate (-48,0)").call(o);p.selectAll("g").classed("gridline",!0),p.selectAll("text").attr("x",4).attr("dy",-4),c.append("g").attr("class","vertical x axis").attr("transform","translate(0,"+a+")").call(n);var q=c.selectAll(".layer").data(d).enter().append("g").attr("class","layer").style("fill",function(a){return k(a[0].category)}),r=q.selectAll("rect").data(function(a){return a}).enter().append("rect").attr("y",a).attr("x",function(a){return f(a.x)}).attr("height",0).attr("fill",e.barColor).attr("width",f.rangeBand());r.transition().delay(function(a,b){return 40*b}).attr("y",function(a){return m(a.y0+a.y)}).attr("height",function(a){return m(a.y0)-m(a.y0+a.y)}),c.selectAll(".value").data(e.lastLayer(d)).enter().append("text").attr("text-anchor","middle").attr("y",function(a){return m(a.y0+a.y)-4}).attr("x",function(a){return f(a.x)+f.rangeBand()/2}).attr("class","value").text(e.textFormat)},e.drawHorizontal=function(){var a=e.graphicHeight(),b=e.graphicWidth(),c=e.graphic();g.rangeRoundBands([0,a],.2),h.range([0,b]),i.scale(h).tickSize(-a).tickPadding(3).tickFormat(l).outerTickSize([0]).orient("bottom"),j.scale(g).tickSize(0).orient("left"),c.append("g").attr("class","horizontal y axis").call(j);var f=c.append("g").attr("class","horizontal x axis").attr("transform","translate(0,"+a+")").call(i);f.selectAll("g").classed("gridline",!0),f.selectAll("text").attr("x",18);var k=c.selectAll(".layer").data(d).enter().append("g").attr("class","layer"),m=k.selectAll("rect").data(function(a){return a}).enter().append("rect").attr("x",0).attr("y",function(a){return g(a.x)}).attr("width",0).attr("fill",e.barColor).attr("height",g.rangeBand());m.transition().delay(function(a,b){return 40*b}).attr("x",function(a){return h(a.y0)}).attr("width",function(a){return h(a.y)}),c.selectAll(".value").data(e.lastLayer(d)).enter().append("text").attr("x",function(a){return h(a.y+a.y0)+5}).attr("y",function(a){return g(a.x)+g.rangeBand()/2+4}).attr("class","value").text(e.textFormat)},e},(null===d3.charts||"object"!=typeof d3.charts)&&(d3.charts={}),this.d3.charts.chartTitle=function(){"use strict";function a(a){a.each(function(){var f=a.append("g").attr("class","chart-title");f.attr("transform","translate("+b+","+c+")"),f.append("text").attr("x",0).attr("y",0).attr("dy",".35em").style("text-anchor","start").attr("class","header").text(d),f.append("text").attr("x",0).attr("y",15).attr("dy",".35em").style("text-anchor","start").text(e)})}var b=0,c=0,d="Lorem",e="Ipsum";return a.x=function(c){return arguments.length?(b=c,a):b},a.y=function(b){return arguments.length?(c=b,a):c},a.title=function(b){return arguments.length?(d=b,a):d},a.subTitle=function(b){return arguments.length?(e=b,a):e},a},(null===d3.charts||"object"!=typeof d3.charts)&&(d3.charts={}),this.d3.charts.baseChart=function(){"use strict";var a,b,c={},d=function(d){d.each(function(d){var e=b(this,d,c);e.draw(),a=e.svg()})};return d.config=function(a,b){return arguments.length?(void 0!==b&&(c[a]=b),d[a]=function(b){return arguments.length?(c[a]=b,d):c[a]},d):c},d.builder=function(a){return arguments.length?(b=a,d):b},d.config("width",900).config("height",500).config("title","TITLE GOES HERE").config("subtitle","Subtitle goes here").config("margin",{top:8,right:8,bottom:8,left:8,leftLabel:168,bottomLabel:40,legend:168,title:30}).config("leftLabels",!0).config("bottomLabels",!0).config("chartArea",!1).config("graphicArea",!1).config("legend",!0).config("titleOn",!0),d.svg=function(){return a},d},(null===d3.charts||"object"!=typeof d3.charts)&&(d3.charts={}),this.d3.charts.groupStack=function(){"use strict";var a=d3.charts.baseChart().config("chartArea",!1).config("graphicArea",!1).config("legend",!0).config("leftLabels",!0).config("bottomLabels",!0).config("titleOn",!0).config("vertical",!1).builder(d3.charts.childBuilder);return a},(null===d3.charts||"object"!=typeof d3.charts)&&(d3.charts={}),this.d3.charts.filter=function(){"use strict";function a(a){a.each(function(a){a.unshift("Select"),d=d3.select(this).append("div");var b=d.append("select"),c=b.selectAll("option").data(a);c.enter().append("option").attr("value",function(a){return a}).attr("subcategory",function(a){return a}).text(function(a){return a})})}var b=960,c=500,d={};return a.width=function(c){return arguments.length?(b=c,a):b},a.height=function(b){return arguments.length?(c=b,a):c},a.svg=function(){return d},a},(null===d3.charts||"object"!=typeof d3.charts)&&(d3.charts={}),this.d3.charts.groupStackOld=function(){"use strict";var a=1024,b=500,c={},d={top:10,right:184,bottom:20,left:168},e="STACKED BAR CHART EXAMPLE",f="Subtext as needed",g=!1,h={top:40},i=function(i){var j,k,l,m,n,o,p,q=[],r=d3.scale.ordinal(),s=d3.scale.linear(),t=d3.svg.axis(),u=d3.svg.axis(),v=d3.scale.ordinal(),w=d3.charts.legend(),x=d3.charts.noData(),y=d3.format(".3s"),z=d3.layout.stack(),A=d3.charts.chartTitle(),B=function(a,b){_.isEmpty(b)?D():C(b),E(a)},C=function(a){q=a,o=z(q),p=_.map(o[0],function(a){return a.x}),l=_.reduce(o,function(a,b){return a.push(b[0].category),a},[]),m=d3.max(o,function(a){return d3.max(a,function(a){return a.y0+a.y})}),r.domain(p),s.domain([0,m]),v.domain(l).range(d3.utilities.stackColors),w.color(v)},D=function(){q=[],o=[],p=_.map(_.range(7),function(a){return"Label - "+a}),l=[],r.domain(p)},E=function(e){j=a-d.left-d.right-40,k=b-d.top-d.bottom-h.top,c=d3.select(e).append("svg").attr("class","groupStack").attr("width",j+d.left+d.right+40).attr("height",k+d.top+d.bottom+h.top),n=c.append("g").attr("transform","translate("+d.left+","+(d.top+h.top)+")").attr("class","groupStack")},F=function(){g?G():I()},G=function(){r.rangeRoundBands([0,j],.2),s.range([k,0]);var a=r,b=s,c=u,d=t;d.scale(b).tickSize(j).tickPadding(3).tickFormat(y).outerTickSize([0]).orient("right"),c.scale(a).tickSize(0).orient("bottom");var e=n.append("g").attr("class","vertical y axis").attr("transform","translate (-48,0)").call(d);e.selectAll("g").classed("gridline",!0),e.selectAll("text").attr("x",4).attr("dy",-4),n.append("g").attr("class","vertical x axis").attr("transform","translate(0,"+k+")").call(c);var f=n.selectAll(".layer").data(o).enter().append("g").attr("class","layer").style("fill",function(a){return v(a[0].category)}),g=f.selectAll("rect").data(function(a){return a}).enter().append("rect").attr("y",k).attr("x",function(b){return a(b.x)}).attr("height",0).attr("width",a.rangeBand());g.transition().delay(function(a,b){return 40*b}).attr("y",function(a){return b(a.y0+a.y)}).attr("height",function(a){return b(a.y0)-b(a.y0+a.y)}),n.selectAll(".value").data(H(o)).enter().append("text").attr("text-anchor","middle").attr("y",function(a){return b(a.y0+a.y)-4}).attr("x",function(b){return a(b.x)+a.rangeBand()/2}).attr("class","value").text(function(a){return y(a.y+a.y0)})},H=function(a){return _.isEmpty(a)?[]:_.last(a)},I=function(){r.rangeRoundBands([0,k],.2),s.range([0,j]),t.scale(s).tickSize(-k).tickPadding(3).tickFormat(y).outerTickSize([0]).orient("bottom"),u.scale(r).tickSize(0).orient("left"),n.append("g").attr("class","horizontal y axis").call(u);var a=n.append("g").attr("class","horizontal x axis").attr("transform","translate(0,"+k+")").call(t);a.selectAll("g").classed("gridline",!0),a.selectAll("text").attr("x",18);var b=n.selectAll(".layer").data(o).enter().append("g").attr("class","layer").style("fill",function(a){return v(a[0].category)}),c=b.selectAll("rect").data(function(a){return a}).enter().append("rect").attr("x",0).attr("y",function(a){return r(a.x)}).attr("width",0).attr("height",r.rangeBand());c.transition().delay(function(a,b){return 40*b}).attr("x",function(a){return s(a.y0)}).attr("width",function(a){return s(a.y)}),n.selectAll(".value").data(H(o)).enter().append("text").attr("x",function(a){return s(a.y+a.y0)+5}).attr("y",function(a){return r(a.x)+r.rangeBand()/2+4}).attr("class","value").text(function(a){return y(a.y+a.y0)})},J=function(){A.title(e).subTitle(f),A.x(16).y(d.top),c.call(A)},K=function(){w.y(d.top+h.top).x(j+30+d.right),c.datum(l).call(w)},L=function(){x.x(j/2).y(k/2),c.call(x)};i.each(function(a){B(this,a),F(a),J(),K(),_.isEmpty(a)&&L()})};return i.width=function(b){return arguments.length?(a=b,i):a},i.height=function(a){return arguments.length?(b=a,i):b},i.svg=function(){return c},i.title=function(a){return arguments.length?(e=a,i):e},i.subtitle=function(a){return arguments.length?(f=a,i):f},i.vertical=function(a){return arguments.length?(g=a,i):g},i},(null===d3.charts||"object"!=typeof d3.charts)&&(d3.charts={}),this.d3.charts.heatmap=function(){"use strict";function a(a){var r,s,t,u,v,w,x,y,z,A=!0,B=[],C=d3.scale.ordinal(),D=d3.scale.ordinal(),E=d3.scale.ordinal(),F=d3.charts.noData(),G=(d3.charts.legend(),d3.charts.chartTitle()),H=function(){var a=m.top+n.top+o.top;return a+=A?f:0},I=function(){b&&(s=b*E.domain().length,E.rangeRoundBands([0,s])),c&&(r=c*C.domain().length,C.rangeRoundBands([0,r]),D.rangeRoundBands([0,r]))},J=function(a){r=d-m.left-m.right,s=e-H()-m.bottom,C.rangeRoundBands([0,r]),D.rangeRoundBands([0,r]),E.rangeRoundBands([0,s]),G.title(p).subTitle(q),k=d3.select(a).append("svg").attr("class","heatmap").attr("width",r+m.left+m.right).attr("height",s+H()+m.bottom),t=k.append("g").attr("class","heatmap").attr("transform","translate("+m.left+","+H()+")"),u=k.append("g").attr("class","top-nav").attr("transform","translate("+m.left+","+(H()-o.top)+")"),v=k.append("g").attr("class","left-nav").attr("transform","translate(0,"+H()+")"),w=k.append("meta-data")},K=function(a){B=a,x=d3.utilities.uniqueProperties(a,"name"),D.domain(x),x.length<=1&&(A=!1)},L=function(){A=!1,B=[{data:[]}],_.each(_.range(10),function(a){_.each(_.range(10),function(b){B[0].data.push({xAxis:"Label "+b,yAxis:"Label "+a,color:"#ccc"})})}),l=[{name:"TBD",color:"#ccc"}]},M=function(){z=function(a){y.select(".selected").attr("class",""),y.select('[category="'+a+'"]').attr("class","selected");var b=_.find(B,function(b){return b.name==a}).data;O(b),Q(a)},A?(P(x),z(x[0])):O(B[0].data)},N=function(){G.x(16).y(m.top),k.call(G)},O=function(a){C.domain(d3.utilities.uniqueProperties(a,"xAxis")),E.domain(d3.utilities.uniqueProperties(a,"yAxis")),I();var b=function(a){return _.isEmpty(a.color)?"none":a.color},c=t.selectAll("g.heatmap .square").data(a);c.enter().append("rect").attr("class","square").attr("fill",b),c.attr("x",function(a){return C(a.xAxis)}).attr("y",function(a){return E(a.yAxis)}).attr("rx",0).attr("ry",0).attr("width",C.rangeBand()).attr("height",E.rangeBand()).transition().style("fill",b),c.exit().remove();var d=t.selectAll("g.heatmap .cell.value").data(a);d.enter().append("text"),d.attr("text-anchor","middle").attr("x",function(a){return C(a.xAxis)}).attr("y",function(a){return E(a.yAxis)}).attr("dy",function(){return E.rangeBand()/2+4}).attr("dx",function(){return C.rangeBand()/2}).attr("class","cell value "+i+" "+j).text(function(a){return a.value}),d.exit().remove(),R()},P=function(a){y=k.append("g").attr("class","controls").attr("transform","translate("+m.left+","+(H()-o.top-f)+")"),y.append("rect").attr("class","border").attr("x",0).attr("y",0).attr("rx",4).attr("ry",4).attr("width",r).attr("height",f);var b=y.selectAll(".text").data(a).enter().append("g");b.attr("category",function(a){return a}).append("rect").attr("class","control-box").attr("x",function(a){return D(a)}).attr("y",0).attr("width",D.rangeBand()).attr("height",f),b.append("text").attr("x",function(a){return D(a)+D.rangeBand()/2}).attr("y",20).attr("width",D.rangeBand()).attr("height",f).text(function(a){return a}).attr("style","cursor: pointer;").on("click",z)},Q=function(a){var b=w.selectAll("category").data([a]);b.enter().append("category"),b.text(function(a){return a})},R=function(){var a=u.selectAll("g.top-nav .text").data(C.domain());a.enter().append("svg:foreignObject").attr("class","text").append("xhtml:div").attr("class","column-label "+h).attr("style","height:"+o.top+"px; width:"+C.rangeBand()+"px;").append("xhtml:div").html(function(a){return a}),a.attr("width",C.rangeBand()).attr("height",o.top).attr("x",function(a){return C(a)}).attr("y",function(){return E(E.domain()[0])}),a.exit().remove();var b=v.selectAll("g.left-nav .text").data(E.domain());b.enter().append("svg:foreignObject").attr("class","text").append("xhtml:div").attr("class","row-label "+g).append("xhtml:div").html(function(a){return a}),b.attr("width",m.left).attr("height",E.rangeBand()).attr("x",function(){return C(C.domain()[0])}).attr("y",function(a){return E(a)}).attr("style","line-height:"+E.rangeBand()+"px"),b.exit().remove()},S=function(){var a=d3.scale.ordinal().domain(_.map(l,function(a){return a.name})).range(_.map(l,function(a){return a.color})),b=d3.charts.legend().color(a);b.y(H()).x(r+30+m.right),k.datum(_.map(l,function(a){return a.name})).call(b)},T=function(){F.x(r/2).y(s/2),k.call(F)},U=function(a,b){_.isEmpty(b)?(b=[],L()):K(b),J(a)};a.each(function(a){U(this,a),M(a),N(),S(),_.isEmpty(a)&&T()})}var b,c,d=1e3,e=600,f=30,g="small",h="small",i="small",j="white",k={},l=[],m={top:10,right:184,bottom:20,left:168},n={top:30},o={top:60},p="HEATMAP CHART EXAMPLE",q="Subtext as needed";return a.width=function(b){return arguments.length?(d=b,a):d},a.height=function(b){return arguments.length?(e=b,a):e},a.svg=function(){return k},a.title=function(b){return arguments.length?(p=b,a):p},a.subtitle=function(b){return arguments.length?(q=b,a):q},a.legend=function(b){return arguments.length?(l=b,a):l},a.rowFont=function(b){return arguments.length?(g=b,a):g},a.columnFont=function(b){return arguments.length?(h=b,a):h},a.cellFont=function(b){return arguments.length?(i=b,a):i},a.fixedRowHeight=function(c){return arguments.length?(b=c,a):b},a.fixedColumnWidth=function(b){return arguments.length?(c=b,a):c},a.cellFontColor=function(b){return arguments.length?(j=b,a):j},a},(null===d3.charts||"object"!=typeof d3.charts)&&(d3.charts={}),this.d3.charts.legend=function(){"use strict";function a(a){a.each(function(f){var g=a.append("g").attr("class","legend-container").attr("transform","translate("+b+","+c+")"),h=g.selectAll(".legend").data(f).enter().append("g").attr("class","legend");h.append("rect").attr("x",0).attr("y",function(a,b){return 28*b}).attr("width",17).attr("height",17).attr("fill",function(a){return d(a)}),h.append("text").attr("x",25).attr("y",function(a,b){return 28*b+9}).attr("dy",".35em").style("text-anchor","start").text(function(a){return a}),e&&g.selectAll("g").attr("style","cursor: pointer;").on("click",e)})}var b=0,c=0,d=d3.scale.category10(),e=void 0;return a.x=function(c){return arguments.length?(b=c,a):b},a.y=function(b){return arguments.length?(c=b,a):c},a.color=function(b){return arguments.length?(d=b,a):d},a.click=function(b){return arguments.length?(e=b,a):e},a},(null===d3.charts||"object"!=typeof d3.charts)&&(d3.charts={}),this.d3.charts.noData=function(){"use strict";function a(a){a.each(function(){var d=a.append("g").attr("class","no-data-found").attr("transform","translate("+b+","+c+")");d.append("rect").attr("x",0).attr("y",0).attr("height","100px").attr("width","300px"),d.append("text").attr("x",150).attr("y",55).text("NO DATA FOUND")})}var b=0,c=0;return a.x=function(c){return arguments.length?(b=c,a):b},a.y=function(b){return arguments.length?(c=b,a):c},a},(null===d3.charts||"object"!=typeof d3.charts)&&(d3.charts={}),this.d3.charts.plotmap=function(){"use strict";function a(a){var r,s,t,u,v,w,x,y=d3.scale.ordinal(),z=d3.scale.ordinal(),A=d3.charts.noData(),B=(d3.charts.legend(),d3.charts.chartTitle()),C=function(){var a=m.top+n.top+o.top;return a+=grouped?f:0},D=function(){b&&(s=b*z.domain().length,z.rangeRoundBands([0,s])),c&&(r=c*y.domain().length,y.rangeRoundBands([0,r]),x2.rangeRoundBands([0,r]))},E=function(a){r=d-m.left-m.right,s=e-C()-m.bottom,y.rangeRoundBands([0,r]),x2.rangeRoundBands([0,r]),z.rangeRoundBands([0,s]),B.title(p).subTitle(q),j=d3.select(a).append("svg").attr("class","heatmap").attr("width",r+m.left+m.right).attr("height",s+C()+m.bottom),t=j.append("g").attr("class","heatmap").attr("transform","translate("+m.left+","+C()+")"),u=j.append("g").attr("class","top-nav").attr("transform","translate("+m.left+","+(C()-o.top)+")"),v=j.append("g").attr("class","left-nav").attr("transform","translate(0,"+C()+")"),meta=j.append("meta-data")},F=function(a){l=a,w=d3.utilities.uniqueProperties(a,"name"),x2.domain(w),w.length<=1&&(grouped=!1)},G=function(){grouped=!1,l=[{data:[]}],_.each(_.range(10),function(a){_.each(_.range(10),function(b){l[0].data.push({xAxis:"Label "+b,yAxis:"Label "+a,color:"#ccc"})})}),k=[{name:"TBD",color:"#ccc"}]},H=function(){x=function(a){controls.select(".selected").attr("class",""),controls.select('[category="'+a+'"]').attr("class","selected");var b=_.find(l,function(b){return b.name==a}).data;J(b),L(a)},grouped?(K(w),x(w[0])):J(l[0].data)},I=function(){B.x(16).y(m.top),j.call(B)},J=function(a){y.domain(d3.utilities.uniqueProperties(a,"xAxis")),z.domain(d3.utilities.uniqueProperties(a,"yAxis")),D();var b=heatmap.selectAll("g.heatmap .square").data(a);b.enter().append("rect").attr("class","square").attr("style",function(a){return"fill:"+a.color}),b.attr("x",function(a){return y(a.xAxis)}).attr("y",function(a){return z(a.yAxis)}).attr("rx",0).attr("ry",0).attr("width",y.rangeBand()).attr("height",z.rangeBand()).transition().style("fill",function(a){return a.color}),b.exit().remove();var c=heatmap.selectAll("g.heatmap .cell.value").data(a);c.enter().append("text"),c.attr("text-anchor","middle").attr("x",function(a){return y(a.xAxis)}).attr("y",function(a){return z(a.yAxis)}).attr("dy",function(){return z.rangeBand()/2+4}).attr("dx",function(){return y.rangeBand()/2}).attr("class","cell value "+i).text(function(a){return a.value}),c.exit().remove(),M()},K=function(a){controls=j.append("g").attr("class","controls").attr("transform","translate("+m.left+","+(C()-o.top-f)+")"),controls.append("rect").attr("class","border").attr("x",0).attr("y",0).attr("rx",4).attr("ry",4).attr("width",r).attr("height",f);var b=controls.selectAll(".text").data(a).enter().append("g");b.attr("category",function(a){return a}).append("rect").attr("class","control-box").attr("x",function(a){return x2(a)}).attr("y",0).attr("width",x2.rangeBand()).attr("height",f),b.append("text").attr("x",function(a){return x2(a)+x2.rangeBand()/2}).attr("y",20).attr("width",x2.rangeBand()).attr("height",f).text(function(a){return a}).attr("style","cursor: pointer;").on("click",x)},L=function(a){var b=meta.selectAll("category").data([a]);b.enter().append("category"),b.text(function(a){return a})},M=function(){var a=u.selectAll("g.top-nav .text").data(y.domain());a.enter().append("svg:foreignObject").attr("class","text").append("xhtml:div").attr("class","column-label "+h).attr("style","height:"+o.top+"px; width:"+y.rangeBand()+"px;").append("xhtml:div").html(function(a){return a}),a.attr("width",y.rangeBand()).attr("height",o.top).attr("x",function(a){return y(a)}).attr("y",function(){return z(z.domain()[0])}),a.exit().remove();var b=v.selectAll("g.left-nav .text").data(z.domain());b.enter().append("svg:foreignObject").attr("class","text").append("xhtml:div").attr("class","row-label "+g).append("xhtml:div").html(function(a){return a}),b.attr("width",m.left).attr("height",z.rangeBand()).attr("x",function(){return y(y.domain()[0])}).attr("y",function(a){return z(a)}).attr("style","line-height:"+z.rangeBand()+"px"),b.exit().remove()},N=function(){var a=d3.scale.ordinal().domain(_.map(k,function(a){return a.name})).range(_.map(k,function(a){return a.color})),b=d3.charts.legend().color(a);b.y(C()).x(r+30+m.right),j.datum(_.map(k,function(a){return a.name})).call(b)},O=function(){A.x(r/2).y(s/2),j.call(A)},P=function(a,b){_.isEmpty(b)?(b=[],G()):F(b),E(a)};a.each(function(a){P(this,a),H(),I(),N(),_.isEmpty(a)&&O()})}var b,c,d=1e3,e=600,f=30,g="small",h="small",i="small",j={},k=[],l=[],m={top:10,right:184,bottom:20,left:168},n={top:30},o={top:60},p="HEATMAP CHART EXAMPLE",q="Subtext as needed";return a.width=function(b){return arguments.length?(d=b,a):d},a.height=function(b){return arguments.length?(e=b,a):e},a.svg=function(){return j},a.title=function(b){return arguments.length?(p=b,a):p},a.subtitle=function(b){return arguments.length?(q=b,a):q},a.legend=function(b){return arguments.length?(k=b,a):k},a.rowFont=function(b){return arguments.length?(g=b,a):g},a.columnFont=function(b){return arguments.length?(h=b,a):h},a.cellFont=function(b){return arguments.length?(i=b,a):i},a.fixedRowHeight=function(c){return arguments.length?(b=c,a):b},a.fixedColumnWidth=function(b){return arguments.length?(c=b,a):c},a.plotType=function(b){return arguments.length?(plotType=b,a):plotType},a},(null===d3.charts||"object"!=typeof d3.charts)&&(d3.charts={}),this.d3.charts.timeseries=function(){"use strict";function a(a){var l,m,n,o,p,q,r=d3.time.scale(),s=d3.time.scale(),t=d3.scale.linear(),u=d3.scale.linear(),v=d3.scale.ordinal(),w=d3.charts.legend(),x=d3.charts.chartTitle(),y=d3.charts.noData(),z=d3.svg.brush(),A=d3.svg.axis(),B=d3.svg.axis(),C=d3.svg.axis(),D=d3.svg.line(),E=d3.svg.line(),F=function(a){l=b-e.left-e.right,m=c-(e.top+f.top)-e.bottom,r.range([0,l]),s.range([0,l]),t.range([m,0]),u.range([d,0]),A.scale(r).orient("top").tickFormat(d3.utilities.customTimeFormat).outerTickSize([0]).ticks(8),B.scale(s).orient("bottom").tickFormat(d3.utilities.customTimeFormat).outerTickSize([0]).ticks(12),C.scale(t).orient("right").ticks(10),x.title(i).subTitle(j),h=d3.select(a).append("svg").attr("class","timeseries").attr("width",l+e.left+e.right).attr("height",m+(e.top+f.top)+e.bottom),h.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",l).attr("height",m)},G=function(){var a=new Date,b=new Date;b.setDate(a.getDate()-365),n=["TBD"],v.domain([]).range(["#E6E6E6"]),w.color(v),r.domain([a,b]),t.domain(d3.extent(_.range(100))),s.domain(r.domain()),u.domain(t.domain())},H=function(a){var b=d3.min(a,function(a){return d3.min(a.data,function(a){return a.value})}),c=d3.max(a,function(a){return d3.max(a.data,function(a){return a.value})}),d=d3.utilities.padDomain(t.range()[0],c,30),e=d3.utilities.padDomain(t.range()[0],c,50);n=_.reduce(a,function(a,b){return a.push(b.series),a},[]),b-=e,c+=d,v.domain(n).range(d3.utilities.colorWheel),w.color(v),r.domain(d3.extent(_.flatten(a,function(a){return a.data}),function(a){return a.date}));var f=new Date(r.domain()[1].getTime()+6e4);r.domain([r.domain()[0],f]),t.domain([b,c]),s.domain(r.domain()),u.domain(t.domain()),D.interpolate("cardinal").tension(.88).x(function(a){return r(a.date)}).y(function(a){return t(a.value)}),E.interpolate("cardinal").tension(.88).x(function(a){return s(a.date)}).y(function(a){return u(a.value)})},I=function(a){o=h.append("g").attr("class","chart1").attr("transform","translate("+e.left+","+(e.top+f.top)+")"),o.append("g").attr("class","x axis").attr("transform","translate(0,"+t(t.domain()[0])+")").call(A),C.tickSize(l);var b=o.append("svg:g").attr("class","y axis").call(C);b.selectAll("g").classed("gridline",!0),b.selectAll("text").attr("x",4).attr("dy",-4);var c=o.append("g").attr("class","chart");c.selectAll("path").data(a).enter().append("path").attr("clip-path","url(#clip)").attr("class","line").style("stroke",function(a){return v(a.series)}).style("stroke-width","2px").attr("series",function(a){return a.series}).attr("d",function(a){return D(a.data)}),k&&c.selectAll("circle").data(_.flatten(a,"data")).enter().append("circle").attr("class","circle").attr("clip-path","url(#clip)").style("stroke",function(a){return a.color}).attr("cx",function(a){return r(a.date)}).attr("cy",function(a){return t(a.value)}).attr("r",g),q=function(){r.domain(z.empty()?s.domain():z.extent()),o.selectAll("g.chart path").data(a).attr("d",function(a){return D(a.data)}),o.selectAll("circle").data(_.flatten(a,"data")).attr("cx",function(a){return r(a.date)}).attr("cy",function(a){return t(a.value)}),o.select(".x.axis").call(A)},K(q,a)},J=function(){y.x((l-300)/2).y(m/2),h.call(y)},K=function(a,b){p=h.append("g").attr("class","chart2").attr("transform","translate("+e.left+","+(m+e.top+f.top)+")"),z.x(s).on("brush",a),p.selectAll("path").data(b).enter().append("path").attr("class","minor line").style("stroke-width","1px").attr("d",function(a){return E(a.data)}),p.append("g").attr("class","x axis").attr("transform","translate(0,"+d+")").call(B),s.domain()[0],new Date,z.extent([s.domain()[0],s.domain()[1]]);var c=p.append("g").attr("class","x brush").call(z);c.selectAll("rect").attr("height",d),c.selectAll(".resize").append("path").attr("d",function(a){return d3.utilities.resizeHandles(a,d)})},L=function(){var a=function(a){var b='g.chart1 [series="'+a+'"]',c=o.select(b),d="2px"==c.style("stroke-width")?"10px":"2px";c.transition().style("stroke-width",d)};w.click(a).y(e.top+f.top).x(l+30),h.datum(n).call(w)},M=function(){x.x(e.left).y(e.top),h.call(x)
},N=function(a,b){F(a),_.isEmpty(b)?G():H(b)};a.each(function(a){N(this,a),I(a),M(),L(),_.isEmpty(a)&&J()})}var b=1024,c=500,d=50,e={top:10,right:168,bottom:70,left:16},f={top:40},g=4,h={},i="TIME SERIES CHART EXAMPLE",j="Subtext as needed",k=!1;return a.width=function(c){return arguments.length?(b=c,a):b},a.height=function(b){return arguments.length?(c=b,a):c},a.title=function(b){return arguments.length?(i=b,a):i},a.subtitle=function(b){return arguments.length?(j=b,a):j},a.svg=function(){return h},a.dataPoints=function(b){return arguments.length?(k=b,a):k},a},(null===d3.utilities||"object"!=typeof d3.utilities)&&(d3.utilities={}),this.d3.helpers={timeFormat:function(a){return function(b){for(var c=a.length-1,d=a[c];!d[1](b);)d=a[--c];return d[0](b)}}},this.d3.utilities={uniqueProperties:function(a,b){return _.reduce(a,function(a,c){return a.filter(function(a){return c[b]===a}).length||a.push(c[b]),a},[])},colorWheel:["#F3504F","#F28A00","#F1C40E","#57D68D","#15A085","#00237E","#3398DB","#74DDE8","#9B59B6","#661C79"],stackColors:["#00237E","#3398DB","#85C1E9","#C7DFF1","#00227D"],customTimeFormat:d3.helpers.timeFormat([[d3.time.format("%Y"),function(){return!0}],[d3.time.format("%b"),function(a){return a.getMonth()}],[d3.time.format("%b %d"),function(a){return 1!=a.getDate()}],[d3.time.format("%a %d"),function(a){return a.getDay()&&1!=a.getDate()}],[d3.time.format("%I %p"),function(a){return a.getHours()}],[d3.time.format("%I:%M"),function(a){return a.getMinutes()}],[d3.time.format(":%S"),function(a){return a.getSeconds()}],[d3.time.format(".%L"),function(a){return a.getMilliseconds()}]]),padDomain:function(a,b,c){return c/a*b},linewrap:function(a){var b=a.value,c=d3.select(this);if(b){var d=b.split("<br>");_.each(d,function(a,b){console.log(a);var d=c.append("tspan").text(a).attr("text-anchor","middle");b>0&&d.attr("dx",0).attr("dy","15")})}},resizeHandles:function(a,b){var c=+("e"==a),d=c?1:-1,e=b/3;return"M"+.5*d+","+e+"A6,6 0 0 "+c+" "+6.5*d+","+(e+6)+"V"+(2*e-6)+"A6,6 0 0 "+c+" "+.5*d+","+2*e+"Z"+"M"+2.5*d+","+(e+6)+"V"+(2*e-6)+"M"+4.5*d+","+(e+6)+"V"+(2*e-6)},comma:d3.format(",")};